{# templates/public/deliveries/index.html.twig #}
{% extends 'public/base.html.twig' %} {# Extends your public base layout #}

{% block public_title %}Current Deliveries{% endblock %}

{% block public_content %}
    <div class="container my-5">
        {# Page Title - Adapt style from events/offers page #}
        <h2 class="mb-4 text-center fw-bold text-body-secondary" style="position: relative;">
            <span style="position: relative; z-index: 1; padding: 0 15px; background: var(--bs-body-bg);">Active Deliveries</span>
            <span style="position: absolute; top: 50%; left: 0; right: 0; height: 2px; background: linear-gradient(90deg, transparent, var(--bs-info), transparent); z-index: 0;"></span> {# Use info color? #}
        </h2>

        {# Optional: Add search/filter bar later if needed #}
        {#
        <div class="card shadow-sm mb-4">
            <div class="card-body">
                <form method="get" action="{{ path('app_public_deliveries_index') }}">
                   ... search fields ...
                </form>
            </div>
        </div>
        #}

        {# Deliveries Grid/List #}
        {% if pagination.getTotalItemCount > 0 %}
            <div class="row g-4">
                {% for livraison in pagination %}
                    <div class="col-lg-4 col-md-6 d-flex align-items-stretch"> {# Use d-flex for equal height cards #}
                        <div class="card w-100 border-0 shadow-sm rounded-3 h-100 delivery-card"> {# Added delivery-card class #}
                            <div class="card-body d-flex flex-column">
                                {# Optional Header with ID #}
                                {# <div class="card-title h6 text-muted">Delivery #{{ livraison.id }}</div> #}

                                {# Locations #}
                                <div class="mb-2">
                                    <span class="badge bg-secondary text-uppercase me-1">From</span>
                                    <span class="fw-semibold">{{ livraison.startLocation }}</span>
                                </div>
                                <div class="mb-3">
                                    <span class="badge bg-primary text-uppercase me-1">To</span>
                                    <span class="fw-semibold">{{ livraison.deliveryLocation }}</span>
                                </div>

                                {# Status #}
                                <div class="mb-3">
                                    <span class="badge bg-warning text-dark">
                                        <i class="fas fa-clock me-1"></i> Pending / In Transit
                                    </span>
                                    {# We only show non-delivered ones, so status is always pending/in transit #}
                                </div>

                                {# Package Count #}
                                <div class="fs-sm text-body-secondary mb-3 flex-grow-1"> {# Use flex-grow to push button down #}
                                    <i class="fas fa-box-open me-1 text-muted"></i>
                                    {{ livraison.packages.count }} package(s) included.
                                </div>

                                {# Button (Maybe link to tracking page later) #}
                                <div class="mt-auto pt-2">
                                    <a href="{{ path('app_public_delivery_status', {'id': livraison.id }) }}" class="btn btn-outline-primary w-100 rounded-pill btn-sm">
                                        <i class="fas fa-search-location me-1"></i> View Status {# Link to status page #}
                                    </a>
                                </div>
                            </div> {# End card-body #}
                        </div> {# End card #}
                    </div> {# End col #}
                {% endfor %}
            </div> {# End row #}

            {# Pagination #}
            <div class="mt-4 d-flex justify-content-center">
                {{ knp_pagination_render(pagination) }}
            </div>

        {% else %}
            {# No active deliveries found #}
            <div class="col-12">
                <div class="card shadow-sm">
                    <div class="card-body text-center py-5">
                        <i class="fas fa-shipping-fast text-body-tertiary mb-3" style="font-size: 2.5rem;"></i>
                        <h5 class="text-body-secondary">No Active Deliveries</h5>
                        <p class="text-body-secondary mb-0">There are currently no pending or in-transit deliveries listed.</p>
                    </div>
                </div>
            </div>
        {% endif %}

    </div> {# End container #}
{% endblock %} {# End public_content #}